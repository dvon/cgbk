<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        
        
        <link rel="stylesheet" href="/cgbk/css/trac.css" />
        
        
        <link rel="stylesheet" href="/cgbk/css/style.css" />
        
        
        
        
        <style>
            h1::before {
                content: "1. "
            }
            body {
                counter-reset: lc 1 ec 0;
            }
            .exercise_label::after {
                counter-increment: ec;
                content: counter(lc) "." counter(ec) ".";
            }
        </style>
        
        
    </head>
    <body>
        <div class="content">
            <h1>JavaScript (Part 1)</h1>

<p>These first lessons are meant to teach you (at least one
way) to use Javascript effectively, assuming you have learned basic
object-oriented programming in a language like Java.  Most of
the ideas here come from <em>JavaScript Patterns</em>, by Stoyan
Stefanov, and <em>JavaScript: The Good Parts</em>, by Douglas Crockford.</p>

<p>I suggest you used the Atom text editor, with the &ldquo;jslint&rdquo;
extension installed.  (You&rsquo;ll get a lot of error messages from
the early examples, however, so you might want to disable jslint
initially.)</p>

<h2>Objects</h2>

<p>In JavaScript, you don&rsquo;t need a class to create an object.
Here&rsquo;s code to create an empty object called <code>player</code> and
then give it two fields, <code>holdAmount</code> and <code>score</code>.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Create a new empty object, assign it to player.</span>
<span class="nx">player</span> <span class="o">=</span> <span class="p">{};</span>

<span class="c1">// Add fields.</span>
<span class="nx">player</span><span class="p">.</span><span class="nx">holdAmount</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="nx">player</span><span class="p">.</span><span class="nx">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</code></pre></div>
<p>Here&rsquo;s code to add a method, <code>takeTurn</code>, which simulates a
turn in the dice game &ldquo;Pig&rdquo;
(<a href="https://en.wikipedia.org/wiki/Pig_(dice_game)">https://en.wikipedia.org/wiki/Pig_(dice_game)</a>).</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Add a method.</span>
<span class="nx">player</span><span class="p">.</span><span class="nx">takeTurn</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">turnScore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1">// Keep rolling until reaching holdAmount or rolling</span>
    <span class="c1">// a &quot;pig&quot; (rolling a 1), in which case any points</span>
    <span class="c1">// accumulated during the turn are lost, and the turn</span>
    <span class="c1">// ends.</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">turnScore</span> <span class="o">&lt;</span> <span class="nx">player</span><span class="p">.</span><span class="nx">holdAmount</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rollScore</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">rollScore</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">turnScore</span> <span class="o">+=</span> <span class="nx">rollScore</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">turnScore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Add points accumulated during the turn to overall</span>
    <span class="c1">// score.  (If a pig was rolled, only the points for</span>
    <span class="c1">// the turn are lost, not points from previous turns.)</span>
    <span class="nx">player</span><span class="p">.</span><span class="nx">score</span> <span class="o">+=</span> <span class="nx">turnScore</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<p>If you link to this code from a web page, you can run it in
a browser.  Here&rsquo;s a minimal web page (assuming the code
above is saved in &ldquo;pig.js&rdquo;).</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;UTF-8&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;pig.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div>
<p>If you save this as &ldquo;pig.html&rdquo; in the same folder where you
saved &ldquo;pig.js,&rdquo; and then open &ldquo;pig.html&rdquo; in a web page, it
will run the JavaScript code above.  But you won&rsquo;t see
anything&hellip;until you add the code below, which uses <code>player</code> to
simulate a solitaire version of Pig and prints the results
in the browser&rsquo;s developer console.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Play a solitaire version of Pig.  (How many turns will it</span>
<span class="c1">// take to reach 100 points?)</span>

<span class="nx">turnCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="k">while</span> <span class="p">(</span><span class="nx">player</span><span class="p">.</span><span class="nx">score</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">player</span><span class="p">.</span><span class="nx">takeTurn</span><span class="p">();</span>
    <span class="nx">turnCount</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">player</span><span class="p">.</span><span class="nx">score</span> <span class="o">+</span> <span class="s2">&quot; points in &quot;</span> <span class="o">+</span> <span class="nx">turnCount</span> <span class="o">+</span> <span class="s2">&quot; turns.&quot;</span><span class="p">);</span>
</code></pre></div>
<p><em><strong><span class="exercise_label"></span></strong></em> <em>Enter the code above, saved in &ldquo;pig.html&rdquo; and &ldquo;pig.js,&rdquo; in
the same folder.  Open &ldquo;pig.html&rdquo; in a web browser.  In Chrome,
you will be able to see the output if you choose
&ldquo;More Tools&hellip;Developer Tools&hellip;Console,&rdquo;
starting from the options menu in the upper right.  You&rsquo;ll also
see error messages if you made any mistakes entering the code.
Assuming it&rsquo;s working correctly, you should see a score of at
least 100, earned in something like 10 to 15 turns.</em></p>

<h2>Functions</h2>

<p>In JavaScript, you don&rsquo;t need a class to create an object, as
the code above illustrates.  But what if you want to create two
similar objects, objects that would be instances of a single
class in a typical object-oriented programming language?  You
could just repeat a big chunk of the code above, first creating
<code>player</code> and adding the fields and method, and then creating
<code>player2</code> and adding the same fields and the same method.  But
there is a better way.  You can define a function that creates
a Pig player object, and then each time you need one you can
call the function.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">PigPlayer</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">holdAmount</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">player</span> <span class="o">=</span> <span class="p">{};</span>    <span class="c1">// var makes player local.</span>

    <span class="nx">player</span><span class="p">.</span><span class="nx">holdAmount</span> <span class="o">=</span> <span class="nx">holdAmount</span><span class="p">;</span>
    <span class="nx">player</span><span class="p">.</span><span class="nx">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="nx">player</span><span class="p">.</span><span class="nx">takeTurn</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">turnScore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">while</span> <span class="p">(</span><span class="nx">turnScore</span> <span class="o">&lt;</span> <span class="nx">player</span><span class="p">.</span><span class="nx">holdAmount</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">rollScore</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">rollScore</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">turnScore</span> <span class="o">+=</span> <span class="nx">rollScore</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">turnScore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">player</span><span class="p">.</span><span class="nx">score</span> <span class="o">+=</span> <span class="nx">turnScore</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="nx">player</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<p>Here&rsquo;s how you&rsquo;d use the <code>PigPlayer</code> function to create two
objects you can use to simulate a two-player game of Pig.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">p</span> <span class="o">=</span> <span class="nx">PigPlayer</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span>
<span class="nx">q</span> <span class="o">=</span> <span class="nx">PigPlayer</span><span class="p">(</span><span class="mi">25</span><span class="p">);</span>

<span class="k">while</span> <span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">score</span> <span class="o">&lt;</span> <span class="mi">100</span> <span class="o">&amp;&amp;</span> <span class="nx">q</span><span class="p">.</span><span class="nx">score</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">p</span><span class="p">.</span><span class="nx">takeTurn</span><span class="p">();</span>
    <span class="nx">q</span><span class="p">.</span><span class="nx">takeTurn</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">score</span> <span class="o">&gt;</span> <span class="nx">q</span><span class="p">.</span><span class="nx">score</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;First player won &quot;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">score</span> <span class="o">+</span> <span class="s2">&quot; to &quot;</span> <span class="o">+</span>
            <span class="nx">q</span><span class="p">.</span><span class="nx">score</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">score</span> <span class="o">&lt;</span> <span class="nx">q</span><span class="p">.</span><span class="nx">score</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;First player lost &quot;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">score</span> <span class="o">+</span> <span class="s2">&quot; to &quot;</span> <span class="o">+</span>
            <span class="nx">q</span><span class="p">.</span><span class="nx">score</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;The two players tied at &quot;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">score</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Notice the use of <code>var</code> in the second line of the <code>PigPlayer</code>
function.  By default JavaScript makes every new variable
global.  If you declare the variable with <code>var</code>, however, its
scope will be limited to the function in which it&rsquo;s declared.</p>

<p>In this code, if you take out <code>var</code> the result is that the
first player doesn&rsquo;t get any points.  Why?  The second time
<code>PigPlayer</code> is called, the <code>player</code> object created by the first
call is overwritten by the second.  After this happens, any
time the first player&rsquo;s <code>takeTurn</code> method is called it
updates the second player&rsquo;s <code>player</code> object&rsquo;s <code>score</code> field
rather than that of the first player, so the second player
gets whatever points should have been given to the first.</p>

<p><em><strong><span class="exercise_label"></span></strong></em> <em>Write a modified version of the code above, with <code>var</code>
taken out and additional <code>console.log</code> statements added, to
clearly show the error explained in the previous paragraph.</em></p>

<h2>Constructors</h2>

<p>As shown in the previous example, you can define a function that
returns a new object, something like a constructor in a typical
object-oriented language.  JavaScript actually provides a special
syntax designed for this&mdash;designed to create constructor
functions, using <code>new</code> and <code>this</code> in a way you might expect to
see in a Java program.  Here&rsquo;s our Pig program
again, this time using a proper JavaScript constructor.  (Notice
that <code>takeTurn</code>&rsquo;s variables <code>turnScore</code> and <code>rollScore</code> have been
declared with <code>var</code> to make them local to that function.)</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">PigPlayer</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">holdAmount</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">holdAmount</span> <span class="o">=</span> <span class="nx">holdAmount</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">takeTurn</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">turnScore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">rollScore</span><span class="p">;</span>

        <span class="k">while</span> <span class="p">(</span><span class="nx">turnScore</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">holdAmount</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">rollScore</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">rollScore</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">turnScore</span> <span class="o">+=</span> <span class="nx">rollScore</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">turnScore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">score</span> <span class="o">+=</span> <span class="nx">turnScore</span><span class="p">;</span>
    <span class="p">};</span>
<span class="p">};</span>

<span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PigPlayer</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span>
<span class="nx">q</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PigPlayer</span><span class="p">(</span><span class="mi">25</span><span class="p">);</span>

<span class="k">while</span> <span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">score</span> <span class="o">&lt;</span> <span class="mi">100</span> <span class="o">&amp;&amp;</span> <span class="nx">q</span><span class="p">.</span><span class="nx">score</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">p</span><span class="p">.</span><span class="nx">takeTurn</span><span class="p">();</span>
    <span class="nx">q</span><span class="p">.</span><span class="nx">takeTurn</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">score</span> <span class="o">&gt;</span> <span class="nx">q</span><span class="p">.</span><span class="nx">score</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;First player won &quot;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">score</span> <span class="o">+</span> <span class="s2">&quot; to &quot;</span> <span class="o">+</span>
            <span class="nx">q</span><span class="p">.</span><span class="nx">score</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">score</span> <span class="o">&lt;</span> <span class="nx">q</span><span class="p">.</span><span class="nx">score</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;First player lost &quot;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">score</span> <span class="o">+</span> <span class="s2">&quot; to &quot;</span> <span class="o">+</span>
            <span class="nx">q</span><span class="p">.</span><span class="nx">score</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;The two players tied at &quot;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">score</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p><code>PigPlayer</code> is called with <code>new</code> when <code>p</code> and <code>q</code> are created.
When you call a function with <code>new</code> in JavaScript, a new empty
object will be created and assigned to a local variable <code>this</code>
inside the function.  Within the function you can add fields and
methods to <code>this</code>, the new object, and at the end of the function
<code>this</code> will be returned automatically (as long as the function
doesn&rsquo;t have a <code>return</code> statement).</p>

<p>This is cool&hellip;it makes the code look a lot like what you&rsquo;d see
in a Java program.  But what would happen if you forgot to use
<code>new</code> when you called the function?  You might guess that you&rsquo;d
get an error, since the function tries to add things to <code>this</code>,
but <code>this</code> would be undefined, right?  Not exactly.  If <code>new</code> is
omitted no new object is created and assigned to <code>this</code>, but
<code>this</code> isn&rsquo;t undefined, it refers to a <em>global</em> object.  So
anything added to <code>this</code> in the constructor ends up being a new
global variable.</p>

<p>Besides <code>this</code> referring to a global object (so that anything
added to <code>this</code> becomes a new global), when <code>new</code> is omitted the
function no longer automatically returns <code>this</code>.  For the code
above, that&rsquo;s a very good thing, because it means it means omitting
<code>new</code> will generate an error message.  <code>p</code> (and <code>q</code> as well) ends
up being <code>undefined</code>, since <code>PigPlayer</code> doesn&rsquo;t return anything,
which means <code>p.score</code> will generate an error.  But it would be
possible to write a program in which a missing <code>new</code> doesn&rsquo;t
generate an error&mdash;but does interfere with pre-existing global
variables.  This would be a very bad thing.</p>

<p>Fortunately it&rsquo;s possible to write a constructor function in a
way that makes it work correctly even if <code>new</code> is omitted, as
shown here.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">PigPlayer</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">holdAmount</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// If &quot;new&quot; is omitted when this function is called, &quot;this&quot;</span>
    <span class="c1">// will refer to a global object and therefore won&#39;t be an</span>
    <span class="c1">// instance of PigPlayer.  In that case, replace the bad</span>
    <span class="c1">// function call with one that uses &quot;new&quot;.</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="k">this</span> <span class="k">instanceof</span> <span class="nx">PigPlayer</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">PigPlayer</span><span class="p">(</span><span class="nx">holdAmount</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">holdAmount</span> <span class="o">=</span> <span class="nx">holdAmount</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">takeTurn</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">turnScore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">rollScore</span><span class="p">;</span>

        <span class="k">while</span> <span class="p">(</span><span class="nx">turnScore</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">holdAmount</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">rollScore</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">rollScore</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">turnScore</span> <span class="o">+=</span> <span class="nx">rollScore</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">turnScore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">score</span> <span class="o">+=</span> <span class="nx">turnScore</span><span class="p">;</span>
    <span class="p">};</span>
<span class="p">};</span>
</code></pre></div>
<p><em><strong><span class="exercise_label"></span></strong></em> <em>Write a modified version of the Pig game code above, without the
check for <code>new</code>, with &ldquo;<code>return this;</code>&rdquo; at the end of the
constructor, and without <code>new</code> in the statements that create new
<code>PigPlayer</code> objects.  Add output statements to show that now the
two players both get each other&rsquo;s points, so that they always
tie.</em></p>

<p><em><strong><span class="exercise_label"></span></strong></em> <em>In this example, if the earlier version of the constructor
without the check for <code>new</code> is called without <code>new</code>, you end up
getting an error message because the constructor returns
<code>undefined</code>.  Describe a situation where a missing <code>new</code>, and
resulting global <code>this</code>, might pollute the global scope without
triggering an error.</em></p>

        </div>
    </body>
</html>
